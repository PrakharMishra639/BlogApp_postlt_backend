import { createTestObject, getItem } from './util';
export const Test = '<>!-!_LOI_GENERATE_DESCRIPTIONS_!-!<>';
export const DateItem = 'loi_internal_Date';
export const Url = 'loi_internal_Url';
export const File = 'loi_internal_File';
export const Image = 'loi_internal_Image';
export const Enum = 'loi_internal_Enum';
/**
 * Return a result
 * @param result expected result
 * @param user user object
 * @param state state
 */
export function Give(result, user, state = { permissions: [], examples: [], type: [] }) {
    return {
        // returns value
        ok() {
            if (result === Test) {
                const { previous, ...rest } = state;
                return {
                    ...getItem(rest.permissions, "permissions"),
                    ...getItem(rest.examples, "examples"),
                    ...getItem(rest.type, "type"),
                    ...getItem(rest.format, "format"),
                    ...getItem(rest.description, 'description')
                };
            }
            if (state.permissions.length && !user)
                return undefined;
            if (state.permissions.length && !user.permissions)
                return undefined;
            // if (state.permissions.length && user.permissions.permissions.includes[])
            return result;
        },
        // provides an output description
        description(description) {
            state.description = description;
            return Give(result, result, state);
        },
        // describe permissions
        for(permission) {
            state.permissions.push(permission);
            state.previous = 'permissions';
            return Give(result, user, state);
        },
        // adds another of the previous thing
        or(item) {
            if (state.previous)
                state[state.previous].push(item);
            return Give(result, user, state);
        },
        // adds another of the previous thing
        and(item) {
            if (state.previous)
                state[state.previous].push(item);
            return Give(result, user, state);
        },
        // sets the model
        as(model) {
            state.type.push(model);
            state.previous = 'type';
            return Give(result, user, state);
        },
        // sets the format
        format(format) {
            state.format = format;
            state.previous = 'format';
            return Give(result, user, state);
        },
        // sets the minimum
        min() {
            return Give(result, user, state);
        },
        // sets the minimum
        max() {
            return Give(result, user, state);
        },
        // sets an example
        example(example) {
            state.examples.push(example);
            state.previous = 'examples';
            return Give(result, user, state);
        },
        colorEnum(dictionary) {
            state.format = Enum;
            state.enumColors = dictionary;
            return Give(result, user, state);
        }
    };
}
/**
 * generates a description of an output function'
 * @param fn output function to describe
 */
export function Describe(fn) {
    try {
        const keys = Object.keys(fn({}, {}));
        const testObj = createTestObject(keys);
        const obj = Object.entries(fn(testObj, {}))
            .reduce((o, [key, value]) => {
            // If key is not a Loy object
            if (value == Test)
                o[key] = {};
            // if key  id loy object
            else
                o[key] = value;
            return o;
        }, {});
        return obj;
    }
    catch (error) {
        return {};
    }
}
export const give = Give;
export const describe = Describe;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE9BQU8sRUFBRSxNQUFNLFFBQVEsQ0FBQTtBQUlsRCxNQUFNLENBQUMsTUFBTSxJQUFJLEdBQUcsdUNBQXVDLENBQUE7QUFDM0QsTUFBTSxDQUFDLE1BQU0sUUFBUSxHQUFHLG1CQUFtQixDQUFBO0FBQzNDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsR0FBRyxrQkFBa0IsQ0FBQTtBQUNyQyxNQUFNLENBQUMsTUFBTSxJQUFJLEdBQUcsbUJBQW1CLENBQUE7QUFDdkMsTUFBTSxDQUFDLE1BQU0sS0FBSyxHQUFHLG9CQUFvQixDQUFBO0FBQ3pDLE1BQU0sQ0FBQyxNQUFNLElBQUksR0FBRyxtQkFBbUIsQ0FBQTtBQUd2Qzs7Ozs7R0FLRztBQUNILE1BQU0sVUFBVSxJQUFJLENBQUMsTUFBVyxFQUFFLElBQVUsRUFBRSxRQUFhLEVBQUUsV0FBVyxFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUU7SUFDcEcsT0FBTztRQUNMLGdCQUFnQjtRQUNoQixFQUFFO1lBQ0EsSUFBSSxNQUFNLEtBQUssSUFBSSxFQUFFO2dCQUNuQixNQUFNLEVBQUUsUUFBUSxFQUFFLEdBQUcsSUFBSSxFQUFFLEdBQUcsS0FBSyxDQUFBO2dCQUNuQyxPQUFPO29CQUNMLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsYUFBYSxDQUFDO29CQUMzQyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLFVBQVUsQ0FBQztvQkFDckMsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUM7b0JBQzdCLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDO29CQUNqQyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLGFBQWEsQ0FBQztpQkFDNUMsQ0FBQTthQUNGO1lBQ0QsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLE1BQU0sSUFBSSxDQUFDLElBQUk7Z0JBQUUsT0FBTyxTQUFTLENBQUE7WUFDdkQsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXO2dCQUFFLE9BQU8sU0FBUyxDQUFBO1lBQ25FLDJFQUEyRTtZQUMzRSxPQUFPLE1BQU0sQ0FBQTtRQUNmLENBQUM7UUFDRCxpQ0FBaUM7UUFDakMsV0FBVyxDQUFDLFdBQVc7WUFDckIsS0FBSyxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUE7WUFDL0IsT0FBTyxJQUFJLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQTtRQUNwQyxDQUFDO1FBQ0QsdUJBQXVCO1FBQ3ZCLEdBQUcsQ0FBQyxVQUFrRDtZQUNwRCxLQUFLLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUNsQyxLQUFLLENBQUMsUUFBUSxHQUFHLGFBQWEsQ0FBQTtZQUM5QixPQUFPLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFBO1FBQ2xDLENBQUM7UUFDRCxxQ0FBcUM7UUFDckMsRUFBRSxDQUFDLElBQVM7WUFDVixJQUFJLEtBQUssQ0FBQyxRQUFRO2dCQUFFLEtBQUssQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO1lBQ3BELE9BQU8sSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUE7UUFDbEMsQ0FBQztRQUNELHFDQUFxQztRQUNyQyxHQUFHLENBQUMsSUFBUztZQUNYLElBQUksS0FBSyxDQUFDLFFBQVE7Z0JBQUUsS0FBSyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7WUFDcEQsT0FBTyxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQTtRQUNsQyxDQUFDO1FBRUQsaUJBQWlCO1FBQ2pCLEVBQUUsQ0FBQyxLQUFvQjtZQUNyQixLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtZQUN0QixLQUFLLENBQUMsUUFBUSxHQUFHLE1BQU0sQ0FBQTtZQUN2QixPQUFPLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFBO1FBQ2xDLENBQUM7UUFFRCxrQkFBa0I7UUFDbEIsTUFBTSxDQUFDLE1BQXFCO1lBQzFCLEtBQUssQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFBO1lBQ3JCLEtBQUssQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1lBQ3pCLE9BQU8sSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUE7UUFDbEMsQ0FBQztRQUVELG1CQUFtQjtRQUNuQixHQUFHO1lBQ0QsT0FBTyxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQTtRQUNsQyxDQUFDO1FBRUQsbUJBQW1CO1FBQ25CLEdBQUc7WUFDRCxPQUFPLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFBO1FBQ2xDLENBQUM7UUFFRCxrQkFBa0I7UUFDbEIsT0FBTyxDQUFDLE9BQWU7WUFDckIsS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUE7WUFDNUIsS0FBSyxDQUFDLFFBQVEsR0FBRyxVQUFVLENBQUE7WUFFM0IsT0FBTyxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQTtRQUNsQyxDQUFDO1FBRUQsU0FBUyxDQUFDLFVBQXVDO1lBQy9DLEtBQUssQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO1lBQ3BCLEtBQUssQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDO1lBRTlCLE9BQU8sSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDbkMsQ0FBQztLQUNGLENBQUE7QUFDSCxDQUFDO0FBQ0Q7OztHQUdHO0FBRUgsTUFBTSxVQUFVLFFBQVEsQ0FBQyxFQUFZO0lBQ25DLElBQUk7UUFDRixNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQTtRQUVwQyxNQUFNLE9BQU8sR0FBRyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUV2QyxNQUFNLEdBQUcsR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUM7YUFDeEMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxFQUFFLEVBQUU7WUFDMUIsNkJBQTZCO1lBQzdCLElBQUksS0FBSyxJQUFJLElBQUk7Z0JBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQTtZQUM5Qix3QkFBd0I7O2dCQUNuQixDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFBO1lBQ25CLE9BQU8sQ0FBQyxDQUFBO1FBQ1YsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFBO1FBQ1IsT0FBTyxHQUFHLENBQUE7S0FDWDtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ2QsT0FBTyxFQUFFLENBQUE7S0FDVjtBQUNILENBQUM7QUFHRCxNQUFNLENBQUMsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFBO0FBQ3hCLE1BQU0sQ0FBQyxNQUFNLFFBQVEsR0FBRyxRQUFRLENBQUEifQ==