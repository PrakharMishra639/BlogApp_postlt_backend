"use strict";
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
Object.defineProperty(exports, "__esModule", { value: true });
const util_1 = require("./util");
exports.Test = '<>!-!_LOI_GENERATE_DESCRIPTIONS_!-!<>';
exports.DateItem = 'loi_internal_Date';
exports.Url = 'loi_internal_Url';
exports.File = 'loi_internal_File';
exports.Image = 'loi_internal_Image';
exports.Enum = 'loi_internal_Enum';
/**
 * Return a result
 * @param result expected result
 * @param user user object
 * @param state state
 */
function Give(result, user, state = { permissions: [], examples: [], type: [] }) {
    return {
        // returns value
        ok() {
            if (result === exports.Test) {
                const { previous } = state, rest = __rest(state, ["previous"]);
                return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, util_1.getItem(rest.permissions, "permissions")), util_1.getItem(rest.examples, "examples")), util_1.getItem(rest.type, "type")), util_1.getItem(rest.format, "format")), util_1.getItem(rest.description, 'description'));
            }
            if (state.permissions.length && !user)
                return undefined;
            if (state.permissions.length && !user.permissions)
                return undefined;
            // if (state.permissions.length && user.permissions.permissions.includes[])
            return result;
        },
        // provides an output description
        description(description) {
            state.description = description;
            return Give(result, result, state);
        },
        // describe permissions
        for(permission) {
            state.permissions.push(permission);
            state.previous = 'permissions';
            return Give(result, user, state);
        },
        // adds another of the previous thing
        or(item) {
            if (state.previous)
                state[state.previous].push(item);
            return Give(result, user, state);
        },
        // adds another of the previous thing
        and(item) {
            if (state.previous)
                state[state.previous].push(item);
            return Give(result, user, state);
        },
        // sets the model
        as(model) {
            state.type.push(model);
            state.previous = 'type';
            return Give(result, user, state);
        },
        // sets the format
        format(format) {
            state.format = format;
            state.previous = 'format';
            return Give(result, user, state);
        },
        // sets the minimum
        min() {
            return Give(result, user, state);
        },
        // sets the minimum
        max() {
            return Give(result, user, state);
        },
        // sets an example
        example(example) {
            state.examples.push(example);
            state.previous = 'examples';
            return Give(result, user, state);
        },
        colorEnum(dictionary) {
            state.format = exports.Enum;
            state.enumColors = dictionary;
            return Give(result, user, state);
        }
    };
}
exports.Give = Give;
/**
 * generates a description of an output function'
 * @param fn output function to describe
 */
function Describe(fn) {
    try {
        const keys = Object.keys(fn({}, {}));
        const testObj = util_1.createTestObject(keys);
        const obj = Object.entries(fn(testObj, {}))
            .reduce((o, [key, value]) => {
            // If key is not a Loy object
            if (value == exports.Test)
                o[key] = {};
            // if key  id loy object
            else
                o[key] = value;
            return o;
        }, {});
        return obj;
    }
    catch (error) {
        return {};
    }
}
exports.Describe = Describe;
exports.give = Give;
exports.describe = Describe;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBLGlDQUFrRDtBQUlyQyxRQUFBLElBQUksR0FBRyx1Q0FBdUMsQ0FBQTtBQUM5QyxRQUFBLFFBQVEsR0FBRyxtQkFBbUIsQ0FBQTtBQUM5QixRQUFBLEdBQUcsR0FBRyxrQkFBa0IsQ0FBQTtBQUN4QixRQUFBLElBQUksR0FBRyxtQkFBbUIsQ0FBQTtBQUMxQixRQUFBLEtBQUssR0FBRyxvQkFBb0IsQ0FBQTtBQUM1QixRQUFBLElBQUksR0FBRyxtQkFBbUIsQ0FBQTtBQUd2Qzs7Ozs7R0FLRztBQUNILFNBQWdCLElBQUksQ0FBQyxNQUFXLEVBQUUsSUFBVSxFQUFFLFFBQWEsRUFBRSxXQUFXLEVBQUUsRUFBRSxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRTtJQUNwRyxPQUFPO1FBQ0wsZ0JBQWdCO1FBQ2hCLEVBQUU7WUFDQSxJQUFJLE1BQU0sS0FBSyxZQUFJLEVBQUU7Z0JBQ25CLE1BQU0sRUFBRSxRQUFRLEtBQWMsS0FBSyxFQUFqQixrQ0FBaUIsQ0FBQTtnQkFDbkMsaUZBQ0ssY0FBTyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsYUFBYSxDQUFDLEdBQ3hDLGNBQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLFVBQVUsQ0FBQyxHQUNsQyxjQUFPLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsR0FDMUIsY0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLEdBQzlCLGNBQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLGFBQWEsQ0FBQyxFQUM1QzthQUNGO1lBQ0QsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLE1BQU0sSUFBSSxDQUFDLElBQUk7Z0JBQUUsT0FBTyxTQUFTLENBQUE7WUFDdkQsSUFBSSxLQUFL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